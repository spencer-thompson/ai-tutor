(()=>{const t=window.location.origin,e=(window.location.pathname,window.location.hostname.split(".")[0]);async function a(t){let e=await fetch(t,{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}});return await e.json()}!async function(){let s=await a(`${t}/api/v1/users/self`),i=await a(`${t}/api/v1/users/self/courses?enrollment_state=active`),n=await a(`${t}/api/v1/users/self/activity_stream?only_active_courses=true`),o={institution:e,canvas_id:s.id,first_name:s.first_name,last_name:s.last_name,avatar_url:s.avatar_url,courses:i.map((({id:t,name:e,enrollments:a})=>({id:t,name:e,role:a[0].type}))),activity_stream:n.map((({id:t,type:e,title:a,message:s,html_url:i,course_id:n,created_at:o,updated_at:l,read_state:c,late:m,seconds_late:r,missing:d,score:_,assignment_id:p,assignment:u,submission_comments:v})=>({id:t,kind:e,title:a,...null!==s&&{message:s},html_url:i,course_id:n,created_at:o,updated_at:l,read_state:c,...void 0!==m&&{late:m},...void 0!==r&&{seconds_late:r},...void 0!==d&&{missing:d},...void 0!==_&&{score:_},...void 0!==p&&{assignment_id:p},...void 0!==u?.points_possible&&{points_possible:u.points_possible},...v?.length>0&&{submission_comments:v.map((({author_name:t,comment:e})=>({author_name:t,comment:e})))}})))};console.log(o),async function(t,e){let a=await fetch("http://localhost:8080/v1/ingest",{method:"POST",headers:{"Content-Type":"application/json","AITUTOR-API-KEY":"test_key",Accept:"application/json"},body:JSON.stringify(e)});await a.json()}(0,o)}()})();