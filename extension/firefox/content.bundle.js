(()=>{const t=window.location.origin,e=(window.location.pathname,window.location.hostname.split(".")[0]),s="http://localhost:8080/";async function i(t){let e=await fetch(t,{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}});return await e.json()}async function n(t,e){let s=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json","AITUTOR-API-KEY":"test_key",Accept:"application/json"},body:JSON.stringify(e)});return await s.json()}!async function(){let a=await i(`${t}/api/v1/users/self`),o=await i(`${t}/api/v1/users/self/activity_stream?only_active_courses=true`),l=await i(`${t}/api/v1/courses?enrollment_state=active&include[]=concluded&include[]=total_scores&include[]=computed_current_score&include[]=syllabus_body&include[]=public_description&per_page=100`),c=l.map((({id:t,name:e,syllabus_body:s})=>({id:t,name:e,...null!==s&&{syllabus_body:s}})));for(let a=0;a<c.length;a++){let o=(await i(`${t}/api/v1/courses/${c[a].id}/assignments?bucket=upcoming&order_by=due_at&include[]=score_statistics`)).map((({id:t,name:e,description:s,due_at:i,updated_at:n,points_possible:a,html_url:o,rubric:l,lock_at:c,unlock_at:r,locked_for_user:u,submission_types:d})=>({id:t,name:e,description:s,...null!==i&&{due_at:i},updated_at:n,...null!==a&&{points_possible:a},html_url:o,...l?.length>0&&{rubric:l.map((({description:t,points:e})=>({description:t,points:e})))},...null!==c&&{lock_at:c},...null!==r&&{unlock_at:r},locked_for_user:u,submission_types:d})));c[a].assignments=o,c[a].institution=e,console.log(c[a]),n(`${s}course`,c[a])}let r={institution:e,canvas_id:a.id,first_name:a.first_name,last_name:a.last_name,avatar_url:a.avatar_url,courses:l.map((({id:t,name:s,enrollments:i})=>({institution:e,id:t,name:s,role:i[0].type,...null!=i[0].computed_current_score&&{current_score:i[0].computed_current_score}}))),activity_stream:o.map((({id:t,type:e,title:s,message:i,html_url:n,course_id:a,created_at:o,updated_at:l,read_state:c,late:r,seconds_late:u,missing:d,score:_,assignment_id:p,assignment:m,submission_comments:y})=>({id:t,kind:e,title:s,...null!==i&&{message:i},html_url:n,course_id:a,created_at:o,updated_at:l,read_state:c,...void 0!==r&&{late:r},...void 0!==u&&{seconds_late:u},...void 0!==d&&{missing:d},...void 0!==_&&{score:_},...void 0!==p&&{assignment_id:p},...void 0!==m?.points_possible&&{points_possible:m.points_possible},...y?.length>0&&{submission_comments:y.map((({author_name:t,comment:e})=>({author_name:t,comment:e})))}})))};console.log(r),n(`${s}user`,r)}()})();